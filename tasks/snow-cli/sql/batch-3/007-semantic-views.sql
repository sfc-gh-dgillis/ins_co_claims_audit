create or replace semantic view INS_CO.LOSS_CLAIMS.CA_INS_CO
	tables (
		AUTHORIZATION primary key (PERFORMER_ID),
		CLAIMS primary key (CLAIM_NO),
		CLAIM_LINES primary key (LINE_NO),
		FINANCIAL_TRANSACTIONS primary key (LINE_NO),
		INVOICES
	)
	relationships (
		CLAIM_LINES_TO_AUTHORIZATION as CLAIM_LINES(PERFORMER_ID) references AUTHORIZATION(PERFORMER_ID),
		CLAIM_TO_CLAIM_LINES_CLAIM_ID as CLAIM_LINES(CLAIM_NO) references CLAIMS(CLAIM_NO),
		FINANCIAL_TO_CLAIM_LINES as CLAIM_LINES(LINE_NO) references FINANCIAL_TRANSACTIONS(LINE_NO),
		CLAIM_LINES_TO_INVOICE as INVOICES(LINE_NO) references CLAIM_LINES(LINE_NO),
		FINANCIAL_TO_INVOICE as INVOICES(LINE_NO) references FINANCIAL_TRANSACTIONS(LINE_NO)
	)
	facts (
		AUTHORIZATION.FROM_AMT as FROM_AMT with synonyms=('beginning_balance','initial_amount','lower_bound_amount','minimum_amount','starting_amount') comment='The amount of funds being transferred or allocated from one account or source to another.',
		AUTHORIZATION.TO_AMT as TO_AMT with synonyms=('ceiling_amount','end_amount','end_value','max_value','maximum_amount','to_value','upper_bound','upper_limit') comment='The total amount of the authorization.',
		FINANCIAL_TRANSACTIONS.FIN_TX_AMT as FIN_TX_AMT with synonyms=('amount_transacted','financial_amount','financial_transaction_value','payment_amount','transaction_amount','transaction_cost','transaction_value') comment='The amount of the financial transaction.',
		INVOICES.INVOICE_AMOUNT as INVOICE_AMOUNT with synonyms=('amount_billed','billed_amount','invoice_cost','invoice_price','invoice_total','invoice_value','total_due','total_invoice_value') comment='The total amount due on an invoice, representing the sum of all charges, taxes, and fees associated with a specific transaction or order.'
	)
	dimensions (
		AUTHORIZATION.CURRENCY as CURRENCY with synonyms=('bill_type','coin_type','denomination','exchange_unit','legal_tender','monetary_unit','money_unit','tender_type') comment='The currency in which the transaction or authorization was processed.',
		AUTHORIZATION.PERFORMER_ID as PERFORMER_ID with synonyms=('account_id','actor_id','executor_id','operator_id','performer_key','practitioner_id','provider_id','user_id') comment='Unique identifier for the individual or entity responsible for performing a specific task or action.',
		CLAIMS.CAUSE_OF_LOSS as CAUSE_OF_LOSS with synonyms=('accident_cause','claim_cause','claim_reason','damage_cause','incident_cause','loss_cause','loss_origin','loss_reason','reason_for_claim') comment='The reason or event that triggered the insurance claim, such as a natural disaster or accident.',
		CLAIMS.CLAIMANT_ID as CLAIMANT_ID with synonyms=('claimant_identifier','claimant_number','insured_id','insured_party_id','policy_owner_id','policyholder_id') comment='Unique identifier for the individual or entity submitting the claim.',
		CLAIMS.CLAIM_NO as CLAIM_NO with synonyms=('claim_id','claim_identifier','claim_number','claim_reference','policy_claim_number') comment='Unique identifier for a claim, used to distinguish one claim from another.',
		CLAIMS.CLAIM_STATUS as CLAIM_STATUS with synonyms=('claim_decision','claim_disposition','claim_outcome','claim_resolution','claim_result','claim_state','claim_verdict') comment='The current status of the claim, indicating whether it is still being processed (Open) or has been resolved.',
		CLAIMS.CREATED_DATE as CREATED_DATE with synonyms=('created_timestamp','creation_date','date_created','entry_date','insertion_date','record_date','registration_date','submission_date') comment='Date when the claim was created.',
		CLAIMS.FNOL_COMPLETION_DATE as FNOL_COMPLETION_DATE with synonyms=('first_notice_of_loss_completion_date','first_report_of_loss_date','initial_loss_report_date','loss_notification_completion_date','notice_of_loss_completion_date') comment='Date when the First Notice of Loss (FNOL) was completed, marking the initial report of a claim.',
		CLAIMS.LINE_OF_BUSINESS as LINE_OF_BUSINESS with synonyms=('business_line','business_segment','industry','market_segment','product_category','product_line','service_category','service_line') comment='The type of business or industry that the claim is related to, such as property, casualty, or liability.',
		CLAIMS.LOSS_DATE as LOSS_DATE with synonyms=('accident_date','date_of_incident','date_of_loss','incident_date','loss_event_date','loss_occurrence_date') comment='Date on which the loss or damage occurred.',
		CLAIMS.LOSS_DESCRIPTION as LOSS_DESCRIPTION with synonyms=('claim_description','claim_summary','damage_description','incident_description','incident_summary','loss_details','loss_narrative','loss_summary') comment='A brief description of the loss or damage that occurred, as reported by the claimant.',
		CLAIMS.LOSS_STATE as LOSS_STATE with synonyms=('location_of_loss','loss_location','loss_region','loss_state_province','loss_territory','state_of_loss','state_where_loss_occurred') comment='The state in which the loss occurred.',
		CLAIMS.LOSS_ZIP_CODE as LOSS_ZIP_CODE with synonyms=('claim_zip_code','incident_zip','loss_location_zip','loss_postal_code','loss_postcode','loss_zip') comment='The five-digit zip code where the loss occurred.',
		CLAIMS.PERFORMER as PERFORMER with synonyms=('caregiver','doctor','healthcare_provider','medical_professional','nurse','practitioner','provider','service_provider','therapist') comment='The individual or entity that performed the medical service or procedure associated with the claim.',
		CLAIMS.POLICY_NO as POLICY_NO with synonyms=('contract_id','contract_number','policy_code','policy_id','policy_identifier','policy_number') comment='Unique identifier for the insurance policy associated with the claim.',
		CLAIMS.REPORTED_DATE as REPORTED_DATE with synonyms=('claim_reported_date','date_reported','filing_date','incident_reported_date','logged_date','notification_date','reported_on','submission_date') comment='The date on which the claim was reported to the organization.',
		CLAIM_LINES.CLAIMANT_ID as CLAIMANT_ID with synonyms=('claimant_identifier','claimant_number','claimer_id','insured_id','policy_holder_id','policy_owner_id') comment='Unique identifier for the individual or entity submitting the claim.',
		CLAIM_LINES.CLAIM_NO as CLAIM_NO with synonyms=('claim_code','claim_id','claim_identifier','claim_number','claim_reference','policy_number') comment='Unique identifier for a claim, used to track and manage individual claims submitted by patients or healthcare providers for reimbursement or insurance coverage.',
		CLAIM_LINES.CLAIM_STATUS as CLAIM_STATUS with synonyms=('claim_disposition','claim_outcome','claim_phase','claim_progress','claim_resolution','claim_result','claim_state') comment='The current status of a claim, indicating whether it is still being processed (Open) or has been resolved.',
		CLAIM_LINES.LINE_NO as LINE_NO with synonyms=('claim_line_number','line_number','record_number','row_number','sequence_number') comment='Unique identifier for each line item within a claim.',
		CLAIM_LINES.LOSS_DESCRIPTION as LOSS_DESCRIPTION with synonyms=('claim_cause','claim_description','damage_description','incident_description','incident_summary','loss_reason','loss_summary') comment='A brief description of the damage or loss incurred by the policyholder, as reported on the claim.',
		CLAIM_LINES.CREATED_DATE as CREATED_DATE with synonyms=('creation_date','date_created','date_entered','date_recorded','entry_date','record_date','registration_date') comment='Date when the claim line was created.',
		CLAIM_LINES.PERFORMER_ID as PERFORMER_ID with synonyms=('caregiver_id','healthcare_provider_id','medical_professional_id','practitioner_id','provider_id','service_provider_id') comment='The unique identifier of the healthcare provider who performed the medical service or procedure associated with the claim line.',
		CLAIM_LINES.REPORTED_DATE as REPORTED_DATE with synonyms=('date_reported','event_date','filing_date','incident_date','logged_date','occurrence_date','reported_on','submission_date') comment='The date on which the claim was reported to the insurance company.',
		FINANCIAL_TRANSACTIONS.CURRENCY as CURRENCY with synonyms=('coin_type','denomination','exchange_unit','legal_tender','medium_of_exchange','monetary_unit','money_unit','tender_type') comment='The currency in which the financial transaction was made.',
		FINANCIAL_TRANSACTIONS.FINANCIAL_TYPE as FINANCIAL_TYPE with synonyms=('account_type','financial_category','financial_classification','payment_method','transaction_classification','transaction_type') comment='The type of financial transaction, either a Revenue Share Voucher (RSV) or a payment (PAY).',
		FINANCIAL_TRANSACTIONS.FIN_TX_POST_DT as FIN_TX_POST_DT with synonyms=('financial_transaction_date','posting_date','posting_timestamp','transaction_date','transaction_posted_date','transaction_posting_date') comment='Date the financial transaction was posted.',
		FINANCIAL_TRANSACTIONS.FXID as FXID with synonyms=('exchange_id','exchange_transaction_key','financial_exchange_identifier','foreign_exchange_id','transaction_id') comment='Unique identifier for a foreign exchange transaction.',
		FINANCIAL_TRANSACTIONS.LINE_NO as LINE_NO with synonyms=('entry_number','line_number','record_number','row_number','sequence_number','transaction_line') comment='A unique identifier for each line item within a financial transaction.',
		INVOICES.CURRENCY as CURRENCY with synonyms=('coin_type','denomination','exchange_rate_unit','legal_tender','monetary_denomination','monetary_unit','money_unit','tender_type') comment='The currency in which the invoice was issued.',
		INVOICES.DESCRIPTION as DESCRIPTION with synonyms=('item_description','item_info','item_note','item_text','product_details','product_info','product_note') comment='A categorization of the type of goods or services billed to a customer, such as materials, equipment, or work performed.',
		INVOICES.INVOICE_DATE as INVOICE_DATE with synonyms=('bill_date','billing_date','date_invoiced','document_date','invoice_creation_date','payment_due_date') comment='Date the invoice was issued.',
		INVOICES.INV_ID as INV_ID with synonyms=('invoice_code','invoice_id','invoice_identifier','invoice_number','invoice_reference') comment='Unique identifier for each invoice.',
		INVOICES.INV_LINE_NBR as INV_LINE_NBR with synonyms=('invoice_item_number','invoice_line_id','invoice_line_number','item_number','line_item_number','line_nbr') comment='Unique identifier for each line item on an invoice.',
		INVOICES.LINE_NO as LINE_NO with synonyms=('entry_number','item_number','line_item_number','line_number','row_number','sequence_number') comment='A unique identifier for each line item on an invoice, representing the sequential order in which the items appear on the invoice.',
		INVOICES.VENDOR as VENDOR with synonyms=('contractor','dealer','distributor','manufacturer','merchant','provider','seller','supplier','trader') comment='The name of the vendor or supplier that the invoice is associated with.'
	)
	with extension (CA='{"tables":[{"name":"AUTHORIZATION","dimensions":[{"name":"CURRENCY","sample_values":["USD"]},{"name":"PERFORMER_ID","sample_values":["181","171","191"]}],"facts":[{"name":"FROM_AMT","sample_values":["0.00"]},{"name":"TO_AMT","sample_values":["3000.00","2500.00","5000.00"]}]},{"name":"CLAIMS","dimensions":[{"name":"CAUSE_OF_LOSS","sample_values":["Hurricane"]},{"name":"CLAIM_NO","sample_values":["1899"]},{"name":"CLAIM_STATUS","sample_values":["Open"]},{"name":"CLAIMANT_ID","sample_values":["19"]},{"name":"LINE_OF_BUSINESS","sample_values":["Property"]},{"name":"LOSS_DESCRIPTION","sample_values":["Damaged dwelling and fence after the tree fell"]},{"name":"LOSS_STATE","sample_values":["NJ"]},{"name":"LOSS_ZIP_CODE","sample_values":["8820"]},{"name":"PERFORMER","sample_values":["18"]},{"name":"POLICY_NO","sample_values":["888"]}],"time_dimensions":[{"name":"CREATED_DATE","sample_values":["2025-01-06"]},{"name":"FNOL_COMPLETION_DATE","sample_values":["2025-01-06"]},{"name":"LOSS_DATE","sample_values":["2025-01-06"]},{"name":"REPORTED_DATE","sample_values":["2025-01-06"]}]},{"name":"CLAIM_LINES","dimensions":[{"name":"CLAIM_NO","sample_values":["1899"]},{"name":"CLAIM_STATUS","sample_values":["Open"]},{"name":"CLAIMANT_ID","sample_values":["19"]},{"name":"LINE_NO","sample_values":["17","18","16"]},{"name":"LOSS_DESCRIPTION","sample_values":["Damaged Dwelling","Damaged Fence","Damaged Lawn"]},{"name":"PERFORMER_ID","sample_values":["181","171","191"]}],"time_dimensions":[{"name":"CREATED_DATE","sample_values":["2025-01-06"]},{"name":"REPORTED_DATE","sample_values":["2025-01-06"]}]},{"name":"FINANCIAL_TRANSACTIONS","dimensions":[{"name":"CURRENCY","sample_values":["USD"]},{"name":"FINANCIAL_TYPE","sample_values":["RSV","PAY"]},{"name":"FXID","sample_values":["22","23","24"]},{"name":"LINE_NO","sample_values":["17","18","16"]}],"facts":[{"name":"FIN_TX_AMT","sample_values":["3000.00","3500.00","4000.00"]}],"time_dimensions":[{"name":"FIN_TX_POST_DT","sample_values":["2025-03-06","2025-06-15","2025-02-15"]}]},{"name":"INVOICES","dimensions":[{"name":"CURRENCY","sample_values":["USD"]},{"name":"DESCRIPTION","sample_values":["Hardware","Labor","Wooden Logs"]},{"name":"INV_ID","sample_values":["7","5","6"]},{"name":"INV_LINE_NBR","sample_values":["3","2","1"]},{"name":"LINE_NO","sample_values":["16","18","17"]},{"name":"VENDOR","sample_values":["LMN","XYZ","ABC"]}],"facts":[{"name":"INVOICE_AMOUNT","sample_values":["2500.00","1000.00","500.00"]}],"time_dimensions":[{"name":"INVOICE_DATE","sample_values":["2025-05-15","2025-03-18","2025-04-20"]}]}],"relationships":[{"name":"CLAIM_LINES_TO_AUTHORIZATION"},{"name":"CLAIM_TO_CLAIM_LINES_CLAIM_ID"},{"name":"FINANCIAL_TO_CLAIM_LINES"},{"name":"CLAIM_LINES_TO_INVOICE"},{"name":"FINANCIAL_TO_INVOICE"}],"verified_queries":[{"name":"Was a payment made in excess of the performer authority? Please respond yes or no and provide more details if yes.","question":"Was a payment made in excess of the performer authority? Please respond yes or no and provide more details if yes.","sql":"WITH auth_fin_tx AS (\\n  SELECT\\n    a.performer_id,\\n    a.to_amt AS max_authorized_amt,\\n    ft.fin_tx_amt\\n  FROM\\n    authorization AS a\\n    INNER JOIN claim_lines AS cl ON a.performer_id = cl.performer_id\\n    INNER JOIN financial_transactions AS ft ON cl.line_no = ft.line_no\\n)\\nSELECT\\n  performer_id,\\n  max_authorized_amt,\\n  fin_tx_amt,\\n  CASE\\n    WHEN fin_tx_amt > max_authorized_amt THEN ''Yes''\\n    ELSE ''No''\\n  END AS payment_exceeds_authority\\nFROM\\n  auth_fin_tx","use_as_onboarding_question":false,"verified_by":"Marie Duran","verified_at":1755720163},{"name":"Was a payment issued to the vendor 30+ calendar days after the invoice was received? If yes, please provide details","question":"Was a payment issued to the vendor 30+ calendar days after the invoice was received? If yes, please provide details","sql":"WITH invoice_payment AS (\\n  SELECT\\n    i.vendor,\\n    i.invoice_date,\\n    ft.fin_tx_post_dt,\\n    DATEDIFF(DAY, i.invoice_date, ft.fin_tx_post_dt) AS days_between\\n  FROM\\n    invoices AS i\\n    LEFT OUTER JOIN financial_transactions AS ft ON i.line_no = ft.line_no\\n)\\nSELECT\\n  vendor,\\n  invoice_date,\\n  fin_tx_post_dt,\\n  days_between,\\n  CASE\\n    WHEN days_between > 30 THEN ''Yes''\\n    ELSE ''No''\\n  END AS payment_issued_late\\nFROM\\n  invoice_payment","use_as_onboarding_question":false,"verified_by":"Marie Duran","verified_at":1755720298},{"name":"Was a payment issued to the vendor 8-13 calendar days after the invoice was received?","question":"Was a payment issued to the vendor 8-13 calendar days after the invoice was received?","sql":"WITH invoice_payment AS (\\n  SELECT\\n    i.vendor,\\n    i.invoice_date,\\n    ft.fin_tx_post_dt,\\n    DATEDIFF(DAY, i.invoice_date, ft.fin_tx_post_dt) AS days_between\\n  FROM\\n    invoices AS i\\n    LEFT OUTER JOIN financial_transactions AS ft ON i.line_no = ft.line_no\\n)\\nSELECT\\n  vendor,\\n  invoice_date,\\n  fin_tx_post_dt,\\n  days_between,\\n  CASE\\n    WHEN days_between BETWEEN 8\\n    AND 13 THEN ''Yes''\\n    ELSE ''No''\\n  END AS payment_issued_within_range\\nFROM\\n  invoice_payment","use_as_onboarding_question":false,"verified_by":"Marie Duran","verified_at":1755720353}]}'
);
